# Домашнее задание к занятию "3.7. Компьютерные сети, лекция 2"

1. Проверьте список доступных сетевых интерфейсов на вашем компьютере. Какие команды есть для этого в Linux и в Windows?

   **Ответ:** Linux - `ip link`, Windows - `ipconfig`
```shell
vagrant@vagrant:~$ ip -br -c link
lo               UNKNOWN        00:00:00:00:00:00 <LOOPBACK,UP,LOWER_UP> 
eth0             UP             00:1c:42:99:42:19 <BROADCAST,MULTICAST,UP,LOWER_UP> 
```

2. Какой протокол используется для распознавания соседа по сетевому интерфейсу? Какой пакет и команды есть в Linux для этого?
   
   **Ответ:** Для распознавания соседа по сетевому интерфейсу в Linux используется протокол LLDP. Также с помощью ip neigh можно посмотреть сведения о соседе.
```shell
vagrant@vagrant:~$ ip -c neigh
10.211.55.2 dev eth0 lladdr a2:78:17:d7:2d:64 DELAY
10.211.55.1 dev eth0 lladdr 00:1c:42:00:00:18 STALE
fe80::21c:42ff:fe00:18 dev eth0 lladdr 00:1c:42:00:00:18 router STALE
```

3. Какая технология используется для разделения L2 коммутатора на несколько виртуальных сетей? Какой пакет и команды есть в Linux для этого? Приведите пример конфига.

   **Ответ:** Для разделения L2 коммутатора на несколько виртуальных сетей используется VLAN. В линух есть пакет vlan для управления виртуальными сетями. 
```
Пример конфига /etc/network/interfaces 
auto eth1.10
iface eth1.10 inet static
    address 10.0.0.1
    netmask 255.255.255.0
    vlan-raw-device eth1
```

4. Какие типы агрегации интерфейсов есть в Linux? Какие опции есть для балансировки нагрузки? Приведите пример конфига.

   **Ответ:**
```
4.1. Mode-0(balance-rr) – Данный режим используется по умолчанию. Balance-rr обеспечивается балансировку нагрузки и отказоустойчивость. В данном режиме сетевые пакеты отправляются “по кругу”, от первого интерфейса к последнему. Если выходят из строя интерфейсы, пакеты отправляются на остальные оставшиеся. Дополнительной настройки коммутатора не требуется при нахождении портов в одном коммутаторе. При разностных коммутаторах требуется дополнительная настройка.

4.2. Mode-1(active-backup) – Один из интерфейсов работает в активном режиме, остальные в ожидающем. При обнаружении проблем на активном интерфейсе производится переключение на ожидающий интерфейс. Не требует поддержки от коммутатора.

4.3. Mode-2(balance-xor) – Передача пакетов распределяется по типу входящего и исходящего трафика по формуле ((MAC src) XOR (MAC dest)) % число интерфейсов. Режим дает балансировку нагрузки и отказоустойчивость. Не требуется дополнительной настройки коммутатора.

4.4. Mode-3(broadcast) – Происходит передача во все объединенные интерфейсы, тем самым обеспечивая отказоустойчивость. Рекомендуется только для использования MULTICAST трафика.

4.5. Mode-4(802.3ad) – динамическое объединение одинаковых портов. В данном режиме можно значительно увеличить пропускную способность входящего так и исходящего трафика. Для данного режима необходима поддержка и настройка коммутатора.

4.6. Mode-5(balance-tlb) – Адаптивная балансировки нагрузки трафика. Входящий трафик получается только активным интерфейсом, исходящий распределяется в зависимости от текущей загрузки канала каждого интерфейса. Не требует специальной поддержки и настройки коммутатора/коммутаторов.

4.7. Mode-6(balance-alb) – Адаптивная балансировка нагрузки. Отличается более совершенным алгоритмом балансировки нагрузки чем Mode-5. Обеспечивает балансировку нагрузки как исходящего так и входящего трафика. Не требует специальной поддержки и настройки коммутатора/коммутаторов.
```

```
Пример конфига /etc/network/interfaces
auto bond0
iface bond0 inet dhcp
   bond-slaves eth0 eth1
   bond-mode active-backup
   bond-miimon 100
   bond-primary eth0 eth1
```

5. Сколько IP адресов в сети с маской /29 ? Сколько /29 подсетей можно получить из сети с маской /24. Приведите несколько примеров /29 подсетей внутри сети 10.10.10.0/24.

   **Ответ:** Разобьём сеть 10.10.10.0/24 на подсети /29 с помощью команды sipcalc

```shell
vagrant@vagrant:~$ sipcalc 10.10.10.0/24  -s 29 | grep Network
Network			- 10.10.10.0      - 10.10.10.7
Network			- 10.10.10.8      - 10.10.10.15
Network			- 10.10.10.16     - 10.10.10.23
Network			- 10.10.10.24     - 10.10.10.31
Network			- 10.10.10.32     - 10.10.10.39
Network			- 10.10.10.40     - 10.10.10.47
Network			- 10.10.10.48     - 10.10.10.55
Network			- 10.10.10.56     - 10.10.10.63
Network			- 10.10.10.64     - 10.10.10.71
Network			- 10.10.10.72     - 10.10.10.79
Network			- 10.10.10.80     - 10.10.10.87
Network			- 10.10.10.88     - 10.10.10.95
Network			- 10.10.10.96     - 10.10.10.103
Network			- 10.10.10.104    - 10.10.10.111
Network			- 10.10.10.112    - 10.10.10.119
Network			- 10.10.10.120    - 10.10.10.127
Network			- 10.10.10.128    - 10.10.10.135
Network			- 10.10.10.136    - 10.10.10.143
Network			- 10.10.10.144    - 10.10.10.151
Network			- 10.10.10.152    - 10.10.10.159
Network			- 10.10.10.160    - 10.10.10.167
Network			- 10.10.10.168    - 10.10.10.175
Network			- 10.10.10.176    - 10.10.10.183
Network			- 10.10.10.184    - 10.10.10.191
Network			- 10.10.10.192    - 10.10.10.199
Network			- 10.10.10.200    - 10.10.10.207
Network			- 10.10.10.208    - 10.10.10.215
Network			- 10.10.10.216    - 10.10.10.223
Network			- 10.10.10.224    - 10.10.10.231
Network			- 10.10.10.232    - 10.10.10.239
Network			- 10.10.10.240    - 10.10.10.247
Network			- 10.10.10.248    - 10.10.10.255
```
Подсчитаем количество сетей /29 в сети /24:

```shell
vagrant@vagrant:~$ sipcalc 10.10.10.0/24  -s 29 | grep Network | wc
     32     160    1363
```
Видим, что в сети с маской 255.255.255.0 32 подсети с маской 255.255.255.248.

6. Задача: вас попросили организовать стык между 2-мя организациями. Диапазоны 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 уже заняты. Из какой подсети допустимо взять частные IP адреса? Маску выберите из расчета максимум 40-50 хостов внутри подсети.

   **Ответ:** Для организации стыка между сетями с диапазонами 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 можно использовать сеть 100.64.0.0/26, которая обеспечивает 64 адреса в сети. Пример:
```shell
vagrant@vagrant:~$ sipcalc 100.64.0.0/26
-[ipv4 : 100.64.0.0/26] - 0

[CIDR]
Host address		- 100.64.0.0
Host address (decimal)	- 1681915904
Host address (hex)	- 64400000
Network address		- 100.64.0.0
Network mask		- 255.255.255.192
Network mask (bits)	- 26
Network mask (hex)	- FFFFFFC0
Broadcast address	- 100.64.0.63
Cisco wildcard		- 0.0.0.63
Addresses in network	- 64
Network range		- 100.64.0.0 - 100.64.0.63
Usable range		- 100.64.0.1 - 100.64.0.62
```

7. Как проверить ARP таблицу в Linux, Windows? Как очистить ARP кеш полностью? Как из ARP таблицы удалить только один нужный IP?

   **Ответ:** Проверить ARP таблицу в Linux можно следующими командами
```shell
vagrant@vagrant:~$ ip neigh
10.211.55.2 dev eth0 lladdr a2:78:17:d7:2d:64 DELAY
10.211.55.1 dev eth0 lladdr 00:1c:42:00:00:18 STALE
fe80::21c:42ff:fe00:18 dev eth0 lladdr 00:1c:42:00:00:18 router STALE
```

Удалить одну запись из таблицы ARP можно командой `ip neigh flush IP_Address` или `arp -d IP_Address`.

Очистить польностью таблицу можно командой `ip neigh flush all`.

8*. Установите эмулятор EVE-ng.

   **Ответ:** на Mac с M1 так и не смог запустить EVE-ng.